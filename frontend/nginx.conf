server {
    listen 80;
    server_name _;

    root /usr/share/nginx/html;

    # -----------------------------
    # ðŸ”’ STATIC FILES (FIRST)
    # -----------------------------
    location /js/ {
        try_files $uri =404;
    }

    location ~* \.(js|css|png|jpg|jpeg|svg|ico)$ {
        try_files $uri =404;
    }

    # -----------------------------
    # ROOT
    # -----------------------------
    location = / {
        try_files /main/index.html =404;
    }

    # -----------------------------
    # NORMALIZE (NO PORT DROP)
    # -----------------------------
    absolute_redirect off;
    port_in_redirect off;

    location = /login     { return 301 /login/; }
    location = /register  { return 301 /register/; }
    location = /dashboard { return 301 /dashboard/; }

    # -----------------------------
    # SPA ROUTES
    # -----------------------------
    location /login/ {
        try_files /login/index.html =404;
    }

    location /register/ {
        try_files /register/index.html =404;
    }

    location /dashboard/ {
        try_files /dashboard/index.html =404;
    }

    # -----------------------------
    # API â†’ BACKEND
    # -----------------------------
    location /api/ {
        proxy_pass http://backend:8080;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header Authorization $http_authorization;
    }
}